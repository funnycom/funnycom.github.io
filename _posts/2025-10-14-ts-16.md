---
title: "[TS] HTTP와 API 다루기 - 1"
date: 2025-10-14 23:00:00 +0900
categories: [웹 개발, 타입스크립트]
tags: [웹개발, 타입스크립트, TS, http, api]
pin: true
math: true
mermaid: true
---

> **학습 목표**
> - HTTP 프로토콜이 무엇인지 이해한다
> - REST API의 개념과 설계 원칙을 안다
> - TypeScript에서 API를 호출하고 응답을 처리할 수 있다
> - async/await를 사용하여 비동기 코드를 작성할 수 있다
> - 타입 안전한 API 통신을 구현할 수 있다
> - 에러 처리와 로딩 상태를 관리할 수 있다

---

## HTTP 기초

웹 개발을 하다 보면 서버에서 데이터를 가져오거나 서버로 데이터를 보내야 할 때가 많습니다. 이때 사용하는 것이 바로 HTTP 프로토콜입니다.

### HTTP가 뭔가요?

HTTP(HyperText Transfer Protocol)는 웹에서 데이터를 주고받기 위한 규칙입니다. 쉽게 말하면 "브라우저와 서버가 대화하는 방법"입니다.

**일상 비유:**

```
식당에서 음식을 주문하는 것과 비슷합니다:

손님(클라이언트) → [주문서 전달] → 직원(서버)
손님(클라이언트) ← [음식 제공] ← 직원(서버)

웹에서:
브라우저(클라이언트) → [HTTP 요청] → 서버
브라우저(클라이언트) ← [HTTP 응답] ← 서버
```

### 클라이언트-서버 모델

웹은 클라이언트와 서버가 서로 소통하는 구조로 이루어져 있습니다.

**시각적 이해:**

```
┌─────────────────┐              ┌─────────────────┐
│   클라이언트     │              │     서버        │
│   (브라우저)     │              │   (Backend)     │
├─────────────────┤              ├─────────────────┤
│ - HTML 표시     │              │ - 데이터 저장   │
│ - 사용자 입력   │◄────────────►│ - 비즈니스 로직 │
│ - API 호출      │   HTTP 통신   │ - 데이터 전송   │
└─────────────────┘              └─────────────────┘
```

**클라이언트 (Client)**
- 사용자가 사용하는 프로그램 (브라우저, 앱)
- 서버에 요청을 보내는 쪽
- 데이터를 화면에 표시

**서버 (Server)**
- 데이터를 저장하고 제공하는 컴퓨터
- 클라이언트의 요청에 응답
- 데이터베이스와 연결

### 요청(Request)과 응답(Response)

HTTP 통신은 항상 요청과 응답으로 이루어집니다.

**요청 (Request) - 클라이언트가 서버에게**

```
GET /api/users/1 HTTP/1.1
Host: api.example.com
Content-Type: application/json

어떤 것을 원하는지 (메서드)
어디에 요청하는지 (URL)
어떤 형식인지 (헤더)
추가 데이터 (바디) - 선택사항
```

**응답 (Response) - 서버가 클라이언트에게**

```
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 1,
  "name": "홍길동",
  "email": "hong@example.com"
}

어떤 결과인지 (상태 코드)
어떤 형식인지 (헤더)
실제 데이터 (바디)
```

### HTTP 메서드

HTTP 메서드는 "어떤 작업을 하고 싶은지" 알려주는 것입니다. CRUD(Create, Read, Update, Delete) 작업과 연결됩니다.

**주요 HTTP 메서드:**

```
┌────────────────────────────────────────────────────┐
│  메서드  │  의미     │  CRUD  │       예시          │
├──────────┼───────────┼────────┼─────────────────────┤
│  GET     │ 조회      │ Read   │ 사용자 목록 가져오기 │
│  POST    │ 생성      │ Create │ 새 사용자 생성      │
│  PUT     │ 전체 수정 │ Update │ 사용자 정보 수정    │
│  PATCH   │ 부분 수정 │ Update │ 사용자 이름만 수정  │
│  DELETE  │ 삭제      │ Delete │ 사용자 삭제         │
└────────────────────────────────────────────────────┘
```

**실생활 예시:**

```typescript
// GET - 조회 (읽기만)
// "1번 사용자 정보를 보여주세요"
GET /api/users/1

// POST - 생성 (새로 추가)
// "새로운 사용자를 등록하세요"
POST /api/users
Body: { "name": "홍길동", "email": "hong@example.com" }

// PUT - 전체 수정
// "1번 사용자의 모든 정보를 이것으로 바꾸세요"
PUT /api/users/1
Body: { "name": "김철수", "email": "kim@example.com", "age": 25 }

// PATCH - 부분 수정
// "1번 사용자의 이름만 바꾸세요"
PATCH /api/users/1
Body: { "name": "김철수" }

// DELETE - 삭제
// "1번 사용자를 삭제하세요"
DELETE /api/users/1
```

### HTTP 상태 코드

서버는 응답할 때 "작업이 어떻게 되었는지" 상태 코드로 알려줍니다.

**주요 상태 코드:**

```
┌────────────────────────────────────────────────────┐
│  코드  │  의미              │       설명            │
├────────┼────────────────────┼───────────────────────┤
│  200   │ OK                 │ 성공                  │
│  201   │ Created            │ 생성 성공             │
│  204   │ No Content         │ 성공 (응답 데이터 없음)│
├────────┼────────────────────┼───────────────────────┤
│  400   │ Bad Request        │ 잘못된 요청           │
│  401   │ Unauthorized       │ 인증 필요             │
│  403   │ Forbidden          │ 권한 없음             │
│  404   │ Not Found          │ 찾을 수 없음          │
├────────┼────────────────────┼───────────────────────┤
│  500   │ Internal Server    │ 서버 내부 오류        │
│        │ Error              │                       │
│  503   │ Service Unavailable│ 서비스 이용 불가      │
└────────────────────────────────────────────────────┘

2xx: 성공 ✅
3xx: 리다이렉션 (다른 곳으로 이동)
4xx: 클라이언트 오류 (잘못 요청함) ❌
5xx: 서버 오류 (서버에 문제가 있음) 🔥
```

**상태 코드 예시:**

```typescript
// 200 OK - 성공
// 사용자 정보를 성공적으로 가져옴
GET /api/users/1 → 200 OK

// 201 Created - 생성 성공
// 새 사용자가 성공적으로 생성됨
POST /api/users → 201 Created

// 404 Not Found - 찾을 수 없음
// 99번 사용자가 존재하지 않음
GET /api/users/99 → 404 Not Found

// 400 Bad Request - 잘못된 요청
// 필수 항목(이메일)이 없음
POST /api/users
Body: { "name": "홍길동" } → 400 Bad Request

// 500 Internal Server Error - 서버 오류
// 서버에서 예상치 못한 오류 발생
GET /api/users → 500 Internal Server Error
```

### 헤더(Header)와 바디(Body)

HTTP 메시지는 헤더와 바디로 구성됩니다.

**헤더 (Header)**

헤더는 "메타데이터"입니다. 데이터 자체가 아니라 데이터에 대한 정보를 담습니다.

```typescript
// 주요 헤더들
Content-Type: application/json    // 데이터 형식
Authorization: Bearer token123    // 인증 토큰
Accept: application/json          // 받고 싶은 형식
User-Agent: Mozilla/5.0...        // 클라이언트 정보
```

**바디 (Body)**

바디는 "실제 데이터"입니다.

```typescript
// JSON 형식의 바디
{
  "name": "홍길동",
  "email": "hong@example.com",
  "age": 25
}
```

**전체 예시:**

```typescript
// 요청 예시
POST /api/users HTTP/1.1
Host: api.example.com
Content-Type: application/json        ← 헤더
Authorization: Bearer token123        ← 헤더

{                                     ← 바디 시작
  "name": "홍길동",
  "email": "hong@example.com"
}                                     ← 바디 끝

// 응답 예시
HTTP/1.1 201 Created
Content-Type: application/json        ← 헤더

{                                     ← 바디 시작
  "id": 1,
  "name": "홍길동",
  "email": "hong@example.com",
  "createdAt": "2024-01-15T10:30:00Z"
}                                     ← 바디 끝
```

---

## REST API 이해하기

이제 HTTP를 이해했으니, REST API가 무엇인지 알아봅시다.

### REST API란?

REST(Representational State Transfer) API는 HTTP를 사용하여 서버와 통신하는 "설계 방식"입니다. 웹 API를 만드는 일종의 규칙이라고 생각하면 됩니다.

**쉽게 말하면:**
- HTTP를 "잘" 사용하는 방법
- 직관적이고 일관성 있는 API 설계
- 리소스(자원) 중심으로 생각

### RESTful 설계 원칙

**1. 리소스 중심 설계**

URL은 "행동"이 아니라 "대상(리소스)"을 나타냅니다.

```typescript
// ❌ 나쁜 예 (행동 중심)
GET /getUsers
POST /createUser
POST /updateUser
POST /deleteUser

// ✅ 좋은 예 (리소스 중심)
GET    /users      // 사용자 목록 조회
POST   /users      // 사용자 생성
PUT    /users/1    // 사용자 수정
DELETE /users/1    // 사용자 삭제
```

**2. HTTP 메서드 활용**

같은 URL이라도 메서드에 따라 다른 작업을 수행합니다.

```typescript
// 같은 URL, 다른 메서드 = 다른 작업
GET    /users/1    // 1번 사용자 조회
PUT    /users/1    // 1번 사용자 수정
DELETE /users/1    // 1번 사용자 삭제
```

**3. 계층 구조 표현**

URL로 리소스 간의 관계를 나타냅니다.

```typescript
// 사용자의 게시글
GET /users/1/posts

// 게시글의 댓글
GET /posts/5/comments

// 특정 댓글
GET /posts/5/comments/3
```

**4. 상태 코드 활용**

작업 결과를 적절한 상태 코드로 알립니다.

```typescript
// 성공
200 OK        // 조회 성공
201 Created   // 생성 성공
204 No Content // 삭제 성공 (응답 내용 없음)

// 클라이언트 오류
400 Bad Request   // 잘못된 요청
404 Not Found     // 리소스 없음

// 서버 오류
500 Internal Server Error  // 서버 오류
```

### 엔드포인트(Endpoint)

엔드포인트는 API에 접근할 수 있는 "주소"입니다.

```
엔드포인트 = 기본 URL + 경로

https://api.example.com  /users/1
         ↑                    ↑
     기본 URL               경로
```

**예시:**

```typescript
// 기본 URL
const BASE_URL = "https://api.example.com";

// 엔드포인트들
GET  ${BASE_URL}/users           // 사용자 목록
GET  ${BASE_URL}/users/1         // 1번 사용자
POST ${BASE_URL}/users           // 사용자 생성
GET  ${BASE_URL}/users/1/posts   // 1번 사용자의 게시글
```

### 리소스(Resource)와 URL 구조

REST API는 모든 것을 "리소스"로 생각합니다.

**리소스 예시:**

```
사용자 (User)
게시글 (Post)
댓글 (Comment)
상품 (Product)
주문 (Order)
```

**URL 구조 패턴:**

```typescript
// 컬렉션 (여러 개)
/users              // 모든 사용자
/posts              // 모든 게시글

// 단일 리소스
/users/1            // 1번 사용자
/posts/5            // 5번 게시글

// 중첩 리소스
/users/1/posts      // 1번 사용자의 게시글
/posts/5/comments   // 5번 게시글의 댓글

// 필터링 (쿼리 파라미터)
/users?role=admin       // 관리자만
/posts?published=true   // 공개된 게시글만
/products?category=electronics&sort=price  // 전자제품을 가격순으로
```

### JSON 데이터 형식

REST API는 대부분 JSON 형식으로 데이터를 주고받습니다.

**JSON (JavaScript Object Notation)**

JavaScript 객체와 매우 비슷하지만, 몇 가지 차이가 있습니다.

```typescript
// JavaScript 객체
const user = {
  name: "홍길동",      // 키에 따옴표 없어도 됨
  age: 25,
  isActive: true
};

// JSON (문자열)
{
  "name": "홍길동",    // 키에 반드시 따옴표
  "age": 25,
  "isActive": true
}
```

**JSON 데이터 예시:**

```typescript
// 단일 객체
{
  "id": 1,
  "name": "홍길동",
  "email": "hong@example.com",
  "age": 25,
  "isActive": true
}

// 배열
[
  {
    "id": 1,
    "name": "홍길동"
  },
  {
    "id": 2,
    "name": "김철수"
  }
]

// 중첩 객체
{
  "user": {
    "id": 1,
    "name": "홍길동",
    "profile": {
      "bio": "안녕하세요",
      "avatar": "https://example.com/avatar.jpg"
    }
  },
  "posts": [
    { "id": 1, "title": "첫 번째 글" },
    { "id": 2, "title": "두 번째 글" }
  ]
}
```

**JavaScript와 JSON 변환:**

```typescript
// JavaScript 객체 → JSON 문자열
const user = { name: "홍길동", age: 25 };
const jsonString = JSON.stringify(user);
console.log(jsonString);  // '{"name":"홍길동","age":25}'

// JSON 문자열 → JavaScript 객체
const jsonText = '{"name":"홍길동","age":25}';
const userObj = JSON.parse(jsonText);
console.log(userObj.name);  // "홍길동"
```

### REST API 실제 예시

블로그 시스템의 REST API를 예로 들어봅시다.

```typescript
// 게시글 관련 API

// 1. 모든 게시글 조회
GET /posts
→ 200 OK
[
  { "id": 1, "title": "첫 글", "author": "홍길동" },
  { "id": 2, "title": "둘째 글", "author": "김철수" }
]

// 2. 특정 게시글 조회
GET /posts/1
→ 200 OK
{
  "id": 1,
  "title": "첫 글",
  "content": "내용입니다...",
  "author": "홍길동",
  "createdAt": "2024-01-15T10:30:00Z"
}

// 3. 새 게시글 생성
POST /posts
Body: {
  "title": "새 글",
  "content": "새로운 내용"
}
→ 201 Created
{
  "id": 3,
  "title": "새 글",
  "content": "새로운 내용",
  "author": "홍길동",
  "createdAt": "2024-01-15T11:00:00Z"
}

// 4. 게시글 수정
PUT /posts/1
Body: {
  "title": "수정된 제목",
  "content": "수정된 내용"
}
→ 200 OK
{
  "id": 1,
  "title": "수정된 제목",
  "content": "수정된 내용",
  "updatedAt": "2024-01-15T11:30:00Z"
}

// 5. 게시글 삭제
DELETE /posts/1
→ 204 No Content

// 6. 게시글의 댓글 조회
GET /posts/1/comments
→ 200 OK
[
  { "id": 1, "content": "좋은 글이네요", "author": "김철수" },
  { "id": 2, "content": "감사합니다", "author": "이영희" }
]

// 7. 필터링된 게시글 조회
GET /posts?author=홍길동&published=true
→ 200 OK
[
  { "id": 1, "title": "첫 글", "author": "홍길동" }
]
```

